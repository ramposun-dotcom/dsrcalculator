<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>ëŒ€ì¶œ ì‹¤ë¬´ ê³„ì‚°ê¸°</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#0d1117;
  --surface:#161b22;
  --surface2:#21262d;
  --border:#30363d;
  --border2:#444c56;
  --gold:#d4a853;
  --gold2:#f0c96c;
  --text:#e6edf3;
  --text2:#8b949e;
  --text3:#6e7681;
  --safe:#3fb950;
  --warn:#d29922;
  --danger:#f85149;
  --accent:#58a6ff;
  --radius:12px;
  --radius-sm:8px;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:'Noto Sans KR',sans-serif;
  background:var(--bg);
  color:var(--text);
  min-height:100vh;
  font-size:14px;
}

/* â”€â”€â”€ Header â”€â”€â”€ */
.header{
  background:linear-gradient(135deg,#1a1f2e 0%,#161b22 50%,#1a1208 100%);
  border-bottom:1px solid var(--border);
  padding:20px 24px;
  display:flex;
  align-items:center;
  gap:16px;
}
.header-icon{
  width:44px;height:44px;
  background:linear-gradient(135deg,var(--gold),var(--gold2));
  border-radius:10px;
  display:flex;align-items:center;justify-content:center;
  font-size:20px;
  flex-shrink:0;
}
.header h1{font-size:22px;font-weight:700;letter-spacing:-0.5px;}
.header p{font-size:12px;color:var(--text2);margin-top:2px;}
.header-badge{
  margin-left:auto;
  background:rgba(212,168,83,.15);
  border:1px solid rgba(212,168,83,.3);
  color:var(--gold2);
  padding:4px 10px;
  border-radius:999px;
  font-size:11px;
  font-weight:500;
}

/* â”€â”€â”€ Tabs â”€â”€â”€ */
.tabs-wrap{
  background:var(--surface);
  border-bottom:1px solid var(--border);
  padding:0 24px;
  overflow-x:auto;
  scrollbar-width:none;
}
.tabs-wrap::-webkit-scrollbar{display:none;}
.tabs{
  display:flex;
  gap:0;
  min-width:max-content;
}
.tab{
  padding:14px 18px;
  cursor:pointer;
  font-size:13px;
  font-weight:500;
  color:var(--text2);
  border-bottom:2px solid transparent;
  white-space:nowrap;
  transition:all .2s;
  display:flex;align-items:center;gap:6px;
}
.tab:hover{color:var(--text);}
.tab.active{
  color:var(--gold2);
  border-bottom-color:var(--gold);
}
.tab-icon{font-size:15px;}

/* â”€â”€â”€ Content â”€â”€â”€ */
.content{padding:24px;max-width:1200px;margin:auto;}

.page{display:none;}
.page.active{display:block;}

/* â”€â”€â”€ Cards & Panels â”€â”€â”€ */
.card{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:20px;
  margin-bottom:16px;
}
.card-header{
  display:flex;align-items:center;gap:10px;
  margin-bottom:16px;
  padding-bottom:12px;
  border-bottom:1px solid var(--border);
}
.card-header h2{font-size:15px;font-weight:700;}
.card-tip{
  font-size:11px;color:var(--text2);
  background:var(--surface2);
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  padding:8px 12px;
  line-height:1.6;
  margin-bottom:14px;
}
.card-tip strong{color:var(--gold2);}

.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px;}
.grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;}
@media(max-width:800px){.grid-2,.grid-3{grid-template-columns:1fr;}}

/* â”€â”€â”€ Form Elements â”€â”€â”€ */
.field{margin-bottom:12px;}
.field label{
  display:block;
  font-size:11px;font-weight:600;
  color:var(--text2);
  margin-bottom:5px;
  letter-spacing:.3px;
  text-transform:uppercase;
}
.field input,.field select{
  width:100%;
  background:var(--surface2);
  border:1px solid var(--border);
  border-radius:var(--radius-sm);
  padding:9px 12px;
  color:var(--text);
  font-size:13px;
  font-family:inherit;
  transition:border-color .2s;
}
.field input:focus,.field select:focus{
  outline:none;
  border-color:var(--gold);
}
.field select option{background:var(--surface);}
.field input::placeholder{color:var(--text3);}

.section-label{
  font-size:11px;font-weight:700;
  color:var(--gold);
  text-transform:uppercase;
  letter-spacing:1px;
  margin:16px 0 8px;
}

/* â”€â”€â”€ Loan Rows â”€â”€â”€ */
.loan-table{width:100%;border-collapse:collapse;}
.loan-table th{
  font-size:10px;color:var(--text3);font-weight:600;
  text-transform:uppercase;letter-spacing:.5px;
  padding:6px 8px;
  text-align:left;
  border-bottom:1px solid var(--border);
}
.loan-table td{padding:6px 4px;vertical-align:middle;}
.loan-table td input{
  width:100%;
  background:var(--surface2);
  border:1px solid var(--border);
  border-radius:6px;
  padding:7px 8px;
  color:var(--text);
  font-size:12px;
  font-family:'JetBrains Mono',monospace;
}
.loan-table td input:focus{outline:none;border-color:var(--gold);}
.loan-table td input[readonly]{
  background:var(--bg);
  color:var(--text2);
  cursor:default;
}
.loan-table .type-label{
  font-size:11px;color:var(--text);font-weight:500;
  padding:6px 8px;
  white-space:nowrap;
}
.loan-row:hover td{background:rgba(212,168,83,.03);}

/* â”€â”€â”€ Buttons â”€â”€â”€ */
.btn-row{display:flex;gap:8px;margin-top:16px;}
.btn{
  border:none;border-radius:999px;
  padding:10px 20px;cursor:pointer;
  font-size:13px;font-weight:600;
  font-family:inherit;
  transition:all .15s;
}
.btn-gold{
  background:linear-gradient(135deg,var(--gold),var(--gold2));
  color:#0d1117;
}
.btn-gold:hover{filter:brightness(1.1);transform:translateY(-1px);}
.btn-ghost{
  background:transparent;
  border:1px solid var(--border2);
  color:var(--text2);
}
.btn-ghost:hover{border-color:var(--text2);color:var(--text);}

/* â”€â”€â”€ Result Box â”€â”€â”€ */
.result-box{
  background:var(--surface2);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:16px;
  margin-top:16px;
}
.result-main{
  font-family:'JetBrains Mono',monospace;
  font-size:30px;font-weight:600;
  letter-spacing:-1px;
  line-height:1;
}
.result-safe{color:var(--safe);}
.result-warn{color:var(--warn);}
.result-danger{color:var(--danger);}
.result-neutral{color:var(--gold2);}
.result-label{
  font-size:11px;color:var(--text2);
  margin-top:6px;
}
.result-row{
  display:flex;justify-content:space-between;align-items:center;
  padding:6px 0;
  border-bottom:1px solid var(--border);
  font-size:12px;
}
.result-row:last-child{border-bottom:none;}
.result-row span:first-child{color:var(--text2);}
.result-row span:last-child{
  font-family:'JetBrains Mono',monospace;
  font-weight:600;
  color:var(--text);
}
.result-row.total span:last-child{color:var(--gold2);}
.result-row.dsr-row span:last-child{font-size:15px;}

/* â”€â”€â”€ Badge â”€â”€â”€ */
.badge{
  display:inline-flex;align-items:center;
  padding:3px 8px;border-radius:999px;
  font-size:10px;font-weight:700;
  letter-spacing:.3px;
}
.badge-safe{background:rgba(63,185,80,.15);color:var(--safe);}
.badge-warn{background:rgba(210,153,34,.15);color:var(--warn);}
.badge-danger{background:rgba(248,81,73,.15);color:var(--danger);}

/* â”€â”€â”€ Info Table (ë³´ì¦ë£Œìœ¨ ë“±) â”€â”€â”€ */
.info-table{width:100%;border-collapse:collapse;font-size:12px;}
.info-table th{
  background:var(--surface2);
  padding:8px 10px;text-align:left;
  font-size:10px;color:var(--text3);font-weight:600;
  text-transform:uppercase;letter-spacing:.5px;
}
.info-table td{
  padding:8px 10px;
  border-top:1px solid var(--border);
}
.info-table tr.highlight td{color:var(--gold2);font-weight:600;}

/* â”€â”€â”€ Meter â”€â”€â”€ */
.meter-wrap{margin:10px 0;}
.meter-track{
  height:8px;background:var(--surface2);border-radius:999px;overflow:hidden;
}
.meter-fill{
  height:100%;border-radius:999px;
  background:var(--safe);
  transition:width .5s cubic-bezier(.4,0,.2,1),background .3s;
  max-width:100%;
}

/* â”€â”€â”€ Divider â”€â”€â”€ */
.divider{border:none;border-top:1px solid var(--border);margin:16px 0;}

/* â”€â”€â”€ Note â”€â”€â”€ */
.note{
  font-size:11px;color:var(--text3);
  background:rgba(255,255,255,.02);
  border-left:2px solid var(--border2);
  padding:8px 12px;
  border-radius:0 6px 6px 0;
  line-height:1.7;
  margin-top:8px;
}

/* â”€â”€â”€ Age Income Table â”€â”€â”€ */
.age-table{width:100%;border-collapse:collapse;font-size:12px;margin-top:8px;}
.age-table th{background:var(--surface2);padding:8px;text-align:center;font-size:10px;color:var(--text3);font-weight:600;}
.age-table td{padding:8px;text-align:center;border-top:1px solid var(--border);}
.age-table td:first-child{text-align:left;font-weight:600;color:var(--text2);}

/* Animations */
@keyframes fadeIn{from{opacity:0;transform:translateY(8px);}to{opacity:1;transform:translateY(0);}}
.page.active{animation:fadeIn .25s ease;}
.result-box{animation:fadeIn .2s ease;}
</style>
</head>
<body>

<div class="header">
  <div class="header-icon">ğŸ¦</div>
  <div>
    <h1>ëŒ€ì¶œ ì‹¤ë¬´ ê³„ì‚°ê¸°</h1>
    <p>DSR Â· DTI Â· ì„œìš¸ë³´ì¦ Â· ì£¼íƒë³´ì¦ Â· ë„ì‹œë³´ì¦ Â· ì±„ê¶Œí• ì¸</p>
  </div>
  <div class="header-badge">ì‹¤ë¬´ìš©</div>
</div>

<div class="tabs-wrap">
  <div class="tabs">
    <div class="tab active" onclick="showTab(0)"><span class="tab-icon">ğŸ“Š</span>ë‹´ë³´ëŒ€ì¶œ DSR</div>
    <div class="tab" onclick="showTab(1)"><span class="tab-icon">ğŸ </span>ì „ì„¸ëŒ€ì¶œ DSR</div>
    <div class="tab" onclick="showTab(2)"><span class="tab-icon">ğŸ¢</span>ì„œìš¸ë³´ì¦ DTI</div>
    <div class="tab" onclick="showTab(3)"><span class="tab-icon">ğŸ“</span>ì‹ DTI</div>
    <div class="tab" onclick="showTab(4)"><span class="tab-icon">ğŸ”—</span>ì±„ê¶Œí• ì¸ë¹„ìš©</div>
    <div class="tab" onclick="showTab(5)"><span class="tab-icon">ğŸ“‹</span>ì£¼íƒë³´ì¦ í•œë„/ë³´ì¦ë£Œ</div>
    <div class="tab" onclick="showTab(6)"><span class="tab-icon">ğŸ™ï¸</span>ë„ì‹œë³´ì¦ ë³´ì¦ë£Œ</div>
    <div class="tab" onclick="showTab(7)"><span class="tab-icon">ğŸ“ˆ</span>ì¥ë˜ì†Œë“ í™˜ì‚°</div>
  </div>
</div>

<div class="content">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 0: ë‹´ë³´ëŒ€ì¶œ DSR â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page active" id="page0">
  <div class="card">
    <div class="card-header">
      <span>ğŸ“Š</span>
      <h2>ë‹´ë³´ëŒ€ì¶œ DSR ê³„ì‚°ê¸°</h2>
    </div>
    <div class="card-tip">
      <strong>ì£¼ë‹´ëŒ€</strong>ëŠ” ì›ê¸ˆÂ·ê¸°ê°„Â·ê¸ˆë¦¬ ëª¨ë‘ ì…ë ¥ | <strong>ì „ì„¸Â·ì˜ˆì ê¸ˆ</strong>ì€ ì›ê¸ˆÂ·ê¸ˆë¦¬ ì…ë ¥ | <strong>ê¸°íƒ€(ë¦¬ìŠ¤Â·í• ë¶€Â·ì¹´ë“œë¡ )</strong>ëŠ” 1ë…„ê°„ ì‹¤ì œ ìƒí™˜ì•¡ì„ ì§ì ‘ ì…ë ¥
    </div>

    <div class="field">
      <label>ì—° ì†Œë“</label>
      <input type="text" id="dsr0_income" placeholder="ì˜ˆ: 80,000,000" oninput="fmtMoney(this)">
    </div>

    <div class="section-label">ëŒ€ì¶œ í˜„í™©</div>
    <div style="overflow-x:auto;">
    <table class="loan-table">
      <thead>
        <tr>
          <th style="min-width:130px">ëŒ€ì¶œ ìœ í˜•</th>
          <th style="min-width:120px">ì›ê¸ˆ (ì›)</th>
          <th style="min-width:70px">ê¸°ê°„ (ë…„)</th>
          <th style="min-width:80px">ê¸ˆë¦¬ (%)</th>
          <th style="min-width:120px">ì—°ê°„ ìƒí™˜ì•¡</th>
        </tr>
      </thead>
      <tbody id="dsr0_rows">
        <!-- rows inserted by JS -->
      </tbody>
    </table>
    </div>

    <div class="btn-row">
      <button class="btn btn-gold" onclick="calcDSR0()">DSR ê³„ì‚°í•˜ê¸°</button>
      <button class="btn btn-ghost" onclick="resetDSR0()">ì´ˆê¸°í™”</button>
    </div>

    <div class="result-box" id="dsr0_result" style="display:none">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px;">
        <div>
          <div class="result-main" id="dsr0_pct">0.00%</div>
          <div class="result-label">DSR (ì´ë¶€ì±„ì›ë¦¬ê¸ˆìƒí™˜ë¹„ìœ¨)</div>
        </div>
        <span id="dsr0_badge" class="badge badge-safe">í†µê³¼</span>
      </div>
      <div class="meter-wrap">
        <div class="meter-track"><div class="meter-fill" id="dsr0_meter" style="width:0%"></div></div>
        <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);margin-top:4px;">
          <span>0%</span><span style="color:var(--warn)">40%</span><span style="color:var(--danger)">60%</span><span>100%</span>
        </div>
      </div>
      <hr class="divider">
      <div id="dsr0_detail"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 1: ì „ì„¸ëŒ€ì¶œ DSR â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page1">
  <div class="card">
    <div class="card-header">
      <span>ğŸ </span>
      <h2>ì „ì„¸ëŒ€ì¶œ DSR ê³„ì‚°ê¸°</h2>
    </div>
    <div class="card-tip">
      <strong>ì „ì„¸ìê¸ˆëŒ€ì¶œ</strong>ì€ ì›ê¸ˆÂ·ê¸ˆë¦¬ ì…ë ¥ (ì´ìë§Œ ë°˜ì˜) | ê¸°ì¡´ ì£¼ë‹´ëŒ€ëŠ” ì›ê¸ˆÂ·ê¸°ê°„Â·ê¸ˆë¦¬ ì…ë ¥ | ê¸°íƒ€ëŠ” 1ë…„ ìƒí™˜ì•¡ ì§ì ‘ ì…ë ¥
    </div>

    <div class="field">
      <label>ì—° ì†Œë“</label>
      <input type="text" id="dsr1_income" placeholder="ì˜ˆ: 80,000,000" oninput="fmtMoney(this)">
    </div>

    <div class="section-label">ëŒ€ì¶œ í˜„í™©</div>
    <div style="overflow-x:auto;">
    <table class="loan-table">
      <thead>
        <tr>
          <th style="min-width:130px">ëŒ€ì¶œ ìœ í˜•</th>
          <th style="min-width:120px">ì›ê¸ˆ (ì›)</th>
          <th style="min-width:70px">ê¸°ê°„ (ë…„)</th>
          <th style="min-width:80px">ê¸ˆë¦¬ (%)</th>
          <th style="min-width:120px">ì—°ê°„ ìƒí™˜ì•¡</th>
        </tr>
      </thead>
      <tbody id="dsr1_rows"></tbody>
    </table>
    </div>

    <div class="btn-row">
      <button class="btn btn-gold" onclick="calcDSR1()">DSR ê³„ì‚°í•˜ê¸°</button>
      <button class="btn btn-ghost" onclick="resetDSR1()">ì´ˆê¸°í™”</button>
    </div>

    <div class="result-box" id="dsr1_result" style="display:none">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px;">
        <div>
          <div class="result-main" id="dsr1_pct">0.00%</div>
          <div class="result-label">DSR (ì´ë¶€ì±„ì›ë¦¬ê¸ˆìƒí™˜ë¹„ìœ¨)</div>
        </div>
        <span id="dsr1_badge" class="badge badge-safe">í†µê³¼</span>
      </div>
      <div class="meter-wrap">
        <div class="meter-track"><div class="meter-fill" id="dsr1_meter" style="width:0%"></div></div>
        <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);margin-top:4px;">
          <span>0%</span><span style="color:var(--warn)">40%</span><span style="color:var(--danger)">60%</span><span>100%</span>
        </div>
      </div>
      <hr class="divider">
      <div id="dsr1_detail"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 2: ì„œìš¸ë³´ì¦ DTI â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page2">
  <div class="grid-2">
    <!-- ì„œìš¸ë³´ì¦ ê¸ˆìœµë¹„ìœ¨ -->
    <div class="card">
      <div class="card-header"><span>ğŸ¢</span><h2>ì„œìš¸ë³´ì¦ ê¸ˆìœµë¹„ìœ¨</h2></div>
      <div class="field"><label>ì—° ì†Œë“</label><input type="text" id="sgi_income" placeholder="ì˜ˆ: 30,000,000" oninput="fmtMoney(this)"></div>
      <div class="section-label">ì„œìš¸ë³´ì¦ ëŒ€ì¶œ</div>
      <div class="field"><label>ì„œìš¸ë³´ì¦ ëŒ€ì¶œ ì›ê¸ˆ</label><input type="text" id="sgi_principal" placeholder="ì˜ˆ: 200,000,000" oninput="fmtMoney(this)"></div>
      <div class="field"><label>ì ìš© ê¸ˆë¦¬ (%)</label><input type="number" id="sgi_rate" placeholder="ì˜ˆ: 4.2" step="0.01"></div>
      <div class="section-label">ê¸°íƒ€ ë¶€ì±„ (ë‹´ë³´+ì‹ ìš© í•©ì‚°)</div>
      <div class="field"><label>ê¸°ì¡´ ë¶€ì±„ í•©ê³„</label><input type="text" id="sgi_debt" placeholder="ì˜ˆ: 30,000,000" oninput="fmtMoney(this)"></div>
      <div class="field"><label>ê¸°ì¡´ ë¶€ì±„ ê¸ˆë¦¬ (%)</label><input type="number" id="sgi_debt_rate" placeholder="ì˜ˆ: 4.0" step="0.01"></div>
      <div class="btn-row"><button class="btn btn-gold" onclick="calcSGI()">ê³„ì‚°</button></div>
      <div class="result-box" id="sgi_result" style="display:none">
        <div class="result-main" id="sgi_pct">0.00%</div>
        <div class="result-label">ì„œìš¸ë³´ì¦ ê¸ˆìœµë¹„ìœ¨</div>
        <hr class="divider">
        <div id="sgi_detail"></div>
      </div>
    </div>

    <!-- ì„œìš¸ë³´ì¦ DTI -->
    <div class="card">
      <div class="card-header"><span>ğŸ“‰</span><h2>ì„œìš¸ë³´ì¦ DTI ê³„ì‚°ê¸°</h2></div>
      <div class="field"><label>ì—° ì†Œë“</label><input type="text" id="dti_income" placeholder="ì˜ˆ: 60,000,000" oninput="fmtMoney(this)"></div>
      <div class="section-label">ì‹ ê·œ ì£¼íƒë‹´ë³´ëŒ€ì¶œ (ì‹¤í–‰ì˜ˆì •)</div>
      <div class="field"><label>ëŒ€ì¶œ ì›ê¸ˆ</label><input type="text" id="dti_p" placeholder="ì˜ˆ: 200,000,000" oninput="fmtMoney(this)"></div>
      <div class="field"><label>ëŒ€ì¶œ ê¸°ê°„ (ë…„)</label><input type="number" id="dti_y" placeholder="ì˜ˆ: 40"></div>
      <div class="field"><label>ê¸ˆë¦¬ (%)</label><input type="number" id="dti_r" placeholder="ì˜ˆ: 4.0" step="0.01"></div>
      <div class="section-label">ê¸°ì¡´ ë¶€ì±„</div>
      <div class="field"><label>ê¸°ì¡´ ë¶€ì±„ í•©ê³„</label><input type="text" id="dti_debt" placeholder="ì˜ˆ: 480,000,000" oninput="fmtMoney(this)"></div>
      <div class="field"><label>ê¸°ì¡´ ë¶€ì±„ ê¸ˆë¦¬ (%)</label><input type="number" id="dti_debt_r" placeholder="ì˜ˆ: 5.0" step="0.01"></div>
      <div class="btn-row"><button class="btn btn-gold" onclick="calcDTI()">ê³„ì‚°</button></div>
      <div class="result-box" id="dti_result" style="display:none">
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;">
          <div>
            <div class="result-main" id="dti_pct">0.00%</div>
            <div class="result-label">DTI</div>
          </div>
          <span id="dti_badge" class="badge">-</span>
        </div>
        <div class="meter-wrap">
          <div class="meter-track"><div class="meter-fill" id="dti_meter" style="width:0%"></div></div>
          <div style="display:flex;justify-content:space-between;font-size:10px;color:var(--text3);margin-top:4px;"><span>0%</span><span style="color:var(--warn)">40%</span><span>100%</span></div>
        </div>
        <hr class="divider">
        <div id="dti_detail"></div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 3: ì‹ DTI â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page3">
  <div class="card">
    <div class="card-header"><span>ğŸ“</span><h2>ì‹ DTI ê³„ì‚°ê¸°</h2></div>
    <div class="card-tip">ì£¼íƒë‹´ë³´ëŒ€ì¶œ ì›ë¦¬ê¸ˆ í•©ì‚° ë°©ì‹. ì£¼ë‹´ëŒ€ ìµœëŒ€ 3ê±´ê¹Œì§€ ì…ë ¥ ê°€ëŠ¥.</div>
    <div class="field"><label>ì—° ì†Œë“</label><input type="text" id="ndti_income" placeholder="ì˜ˆ: 70,000,000" oninput="fmtMoney(this)"></div>
    <div class="section-label">ì£¼íƒë‹´ë³´ëŒ€ì¶œ 1 (ì‹ ê·œ ì‹¤í–‰ì˜ˆì •)</div>
    <div class="grid-3">
      <div class="field"><label>ì›ê¸ˆ</label><input type="text" id="ndti_p1" placeholder="ì˜ˆ: 240,000,000" oninput="fmtMoney(this)"></div>
      <div class="field"><label>ê¸°ê°„ (ë…„)</label><input type="number" id="ndti_y1" placeholder="40"></div>
      <div class="field"><label>ê¸ˆë¦¬ (%)</label><input type="number" id="ndti_r1" placeholder="4.7" step="0.01"></div>
    </div>
    <div class="section-label">ì£¼íƒë‹´ë³´ëŒ€ì¶œ 2 (ê¸°ë³´ìœ )</div>
    <div class="grid-3">
      <div class="field"><label>ì›ê¸ˆ</label><input type="text" id="ndti_p2" placeholder="ì˜ˆ: 100,000,000" oninput="fmtMoney(this)"></div>
      <div class="field"><label>ê¸°ê°„ (ë…„)</label><input type="number" id="ndti_y2" placeholder="25"></div>
      <div class="field"><label>ê¸ˆë¦¬ (%)</label><input type="number" id="ndti_r2" placeholder="4.7" step="0.01"></div>
    </div>
    <div class="section-label">ì£¼íƒë‹´ë³´ëŒ€ì¶œ 3 (ê¸°ë³´ìœ )</div>
    <div class="grid-3">
      <div class="field"><label>ì›ê¸ˆ</label><input type="text" id="ndti_p3" placeholder="ì˜ˆ: 50,000,000" oninput="fmtMoney(this)"></div>
      <div class="field"><label>ê¸°ê°„ (ë…„)</label><input type="number" id="ndti_y3" placeholder="20"></div>
      <div class="field"><label>ê¸ˆë¦¬ (%)</label><input type="number" id="ndti_r3" placeholder="4.7" step="0.01"></div>
    </div>
    <div class="btn-row"><button class="btn btn-gold" onclick="calcNDTI()">ì‹ DTI ê³„ì‚°</button><button class="btn btn-ghost" onclick="resetNDTI()">ì´ˆê¸°í™”</button></div>
    <div class="result-box" id="ndti_result" style="display:none">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px;">
        <div>
          <div class="result-main" id="ndti_pct">0.00%</div>
          <div class="result-label">ì‹ DTI</div>
        </div>
        <span id="ndti_badge" class="badge">-</span>
      </div>
      <div class="meter-wrap">
        <div class="meter-track"><div class="meter-fill" id="ndti_meter" style="width:0%"></div></div>
      </div>
      <hr class="divider">
      <div id="ndti_detail"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 4: ì±„ê¶Œí• ì¸ë¹„ìš© â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page4">
  <div class="card" style="max-width:520px">
    <div class="card-header"><span>ğŸ”—</span><h2>ì±„ê¶Œí• ì¸ë¹„ìš© ê³„ì‚°ê¸°</h2></div>
    <div class="note">
      êµ­ë¯¼ì£¼íƒì±„ê¶Œì´ë€? ì •ë¶€ê°€ ì£¼íƒë„ì‹œê¸°ê¸ˆì˜ ë¶€ë‹´ìœ¼ë¡œ ë°œí–‰í•œ ì±„ê¶Œìœ¼ë¡œ, ë“±ê¸°ë¥¼ ì‹ ì²­í•˜ëŠ” ìëŠ” ë§¤ì… ì˜ë¬´ê°€ ìˆìŠµë‹ˆë‹¤. (ì£¼íƒë„ì‹œê¸°ê¸ˆë²• ì œ8ì¡° ì œ1í•­ ì œ2í˜¸)<br>
      âš ï¸ ì±„ê¶Œ í• ì¸ìœ¨ì€ <strong>ë§¤ì¼ ë³€ë™</strong>í•©ë‹ˆë‹¤. ì£¼íƒë„ì‹œê¸°ê¸ˆ ì‚¬ì´íŠ¸ì—ì„œ ë‹¹ì¼ í• ì¸ìœ¨ì„ ì¡°íšŒí•˜ì—¬ ì…ë ¥í•˜ì„¸ìš”. ì •í™•í•œ ë¹„ìš©ì€ ì”ê¸ˆì¼ ê¸°ì¤€ìœ¼ë¡œ ê²°ì •ë©ë‹ˆë‹¤.
    </div>
    <div class="field"><label>ëŒ€ì¶œ ì‹ ì²­ê¸ˆì•¡ (ì›)</label><input type="text" id="bond_amount" placeholder="ì˜ˆ: 100,000,000" oninput="fmtMoney(this)"></div>
    <div class="field"><label>ì±„ê¶Œ í• ì¸ìœ¨ (%)</label><input type="number" id="bond_rate" placeholder="ì˜ˆ: 8.205" step="0.001" value="8.205"></div>
    <div class="btn-row"><button class="btn btn-gold" onclick="calcBond()">ê³„ì‚°í•˜ê¸°</button></div>
    <div class="result-box" id="bond_result" style="display:none">
      <div id="bond_detail"></div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 5: ì£¼íƒë³´ì¦ í•œë„/ë³´ì¦ë£Œ â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page5">
  <div class="grid-2">
    <!-- ëŒ€ì¶œí•œë„ -->
    <div class="card">
      <div class="card-header"><span>ğŸ“‹</span><h2>ì£¼íƒë³´ì¦ ëŒ€ì¶œí•œë„</h2></div>
      <div class="note">1ë…„ ë¯¸ë§Œ ì¬ì§ìëŠ” ì—°ë´‰ í™˜ì‚° ì…ë ¥. 4ëŒ€ë³´í—˜ ì¤‘ ê±´ê°•ë³´í—˜ í¬í•¨ 3ê°œ ë¯¸ë§Œ ê°€ì… ì‹œ ìµœëŒ€ 3ì²œë§Œì› ì¸ì •.</div>
      <div class="field" style="margin-top:12px"><label>ì—° ì†Œë“</label><input type="text" id="hg_income" placeholder="ì˜ˆ: 100,000,000" oninput="fmtMoney(this)"></div>
      <div class="field"><label>ê¸°ì¡´ ë¶€ì±„ í•©ê³„ (ë‹´ë³´+ì‹ ìš©)</label><input type="text" id="hg_debt" placeholder="ì˜ˆ: 300,000,000" oninput="fmtMoney(this)"></div>
      <div class="btn-row"><button class="btn btn-gold" onclick="calcHGLimit()">í•œë„ ê³„ì‚°</button></div>
      <div class="result-box" id="hg_limit_result" style="display:none">
        <table class="info-table" style="width:100%">
          <thead><tr><th>êµ¬ë¶„</th><th>ëŒ€ì¶œí•œë„</th></tr></thead>
          <tbody id="hg_limit_rows"></tbody>
        </table>
      </div>
    </div>

    <!-- ë³´ì¦ë£Œ -->
    <div class="card">
      <div class="card-header"><span>ğŸ’°</span><h2>ì£¼íƒë³´ì¦ ë³´ì¦ë£Œ</h2></div>
      <div class="note">ë³´ì¦ê¸ˆì•¡ 4ì–µ ì´ˆê³¼~5ì–µ ì´í•˜: 0.14% | 5ì–µ ì´ˆê³¼: 0.2% (ìˆ˜ê¸° ê³„ì‚°)<br>1ì£¼íƒ ë³´ìœ ìë¡œ ë¶€ë¶€í•©ì‚° ì†Œë“ 7ì²œë§Œì› ì´ˆê³¼ ì‹œ í• ì¦ë³´ì¦ë£Œ ì ìš©.</div>
      <div class="field" style="margin-top:12px"><label>ëŒ€ì¶œ ì‹ ì²­ê¸ˆì•¡ (ì›)</label><input type="text" id="hg_loan" placeholder="ì˜ˆ: 300,000,000" oninput="fmtMoney(this); calcHGFee()"></div>
      <div class="field">
        <label>êµ¬ë¶„</label>
        <select id="hg_fee_type" onchange="calcHGFee()">
          <option value="normal">ì¼ë°˜ ë³´ì¦ë£Œ</option>
          <option value="surcharge">í• ì¦ ë³´ì¦ë£Œ (1ì£¼íƒ+í•©ì‚°ì†Œë“ 7ì²œë§Œì› ì´ˆê³¼)</option>
          <option value="special">ë‹¤ìë…€Â·ì‹ í˜¼ë¶€ë¶€Â·ì „ìê³„ì•½Â·ì¥ì• ì¸Â·ë‹¤ë¬¸í™”Â·í•©ì‚°ì†Œë“2500ì´í•˜ë¬´ì£¼íƒ</option>
        </select>
      </div>
      <div class="btn-row"><button class="btn btn-gold" onclick="calcHGFee()">ê³„ì‚°</button></div>
      <div class="result-box" id="hg_fee_result" style="display:none">
        <div id="hg_fee_detail"></div>
      </div>
      <div style="margin-top:16px">
        <div class="section-label">ë³´ì¦ê¸ˆì•¡ êµ¬ê°„ë³„ ìš”ìœ¨</div>
        <table class="info-table">
          <thead><tr><th>ë³´ì¦ê¸ˆì•¡ êµ¬ê°„</th><th>ì¼ë°˜</th><th>í• ì¦(+0.2%)</th><th>ìš°ëŒ€</th></tr></thead>
          <tbody>
            <tr><td>1ì–µ ì´í•˜</td><td>0.06%</td><td>0.26%</td><td>0.02%</td></tr>
            <tr><td>1ì–µ ì´ˆê³¼ ~ 2ì–µ ì´í•˜</td><td>0.08%</td><td>0.28%</td><td>0.02%</td></tr>
            <tr><td>2ì–µ ì´ˆê³¼ ~ 3ì–µ ì´í•˜</td><td>0.10%</td><td>0.30%</td><td>0.02%</td></tr>
            <tr><td>3ì–µ ì´ˆê³¼ ~ 4ì–µ ì´í•˜</td><td>0.12%</td><td>0.32%</td><td>0.02%</td></tr>
            <tr><td>4ì–µ ì´ˆê³¼ ~ 5ì–µ ì´í•˜</td><td colspan="3" style="color:var(--warn)">0.14% (ìˆ˜ê¸° ê³„ì‚°)</td></tr>
            <tr><td>5ì–µ ì´ˆê³¼</td><td colspan="3" style="color:var(--danger)">0.20% (ìˆ˜ê¸° ê³„ì‚°)</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 6: ë„ì‹œë³´ì¦ ë³´ì¦ë£Œ â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page6">
  <div class="card" style="max-width:600px">
    <div class="card-header"><span>ğŸ™ï¸</span><h2>ë„ì‹œë³´ì¦ê³µì‚¬ ë³´ì¦ë£Œ ê³„ì‚°ê¸°</h2></div>
    <div class="card-tip">
      ì‚°ì •ëœ ê¸ˆì•¡ì€ <strong>2ë…„ì¹˜ ë³´ì¦ë£Œ</strong>ì…ë‹ˆë‹¤.<br>
      ì¶”ê°€ í• ì¸: ì „ìê³„ì•½ 3% / ëª¨ë²”ë‚©ì„¸ì 10% / ì¸í„°ë„·Â·ëª¨ë°”ì¼ë³´ì¦ 3% / ì¼ì‹œë‚© í• ì¸ 3%(1ë…„ ì´ˆê³¼ë¶„) / ë¶€ì±„ë¹„ìœ¨ 60%ì´í•˜ 10%<br>
      ì„ ìˆœìœ„ ì±„ê¶Œ(ì„ ì„ì°¨í¬í•¨)ì´ ì£¼íƒì‹œì„¸ì˜ 50% ì´ˆê³¼ ì‹œ 10% í• ì¦ (ìˆ˜ê¸° ê³„ì‚°)
    </div>
    <div class="field"><label>ë°˜í™˜ë³´ì¦ ê°€ì…ê¸ˆì•¡ (ì›)</label><input type="text" id="hug_insure" placeholder="ì˜ˆ: 200,000,000" oninput="fmtMoney(this)"></div>
    <div class="field"><label>ëŒ€ì¶œ ì‹ ì²­ê¸ˆì•¡ (ì›)</label><input type="text" id="hug_loan" placeholder="ì˜ˆ: 160,000,000" oninput="fmtMoney(this)"></div>
    <div class="btn-row"><button class="btn btn-gold" onclick="calcHUG()">ë³´ì¦ë£Œ ê³„ì‚°</button></div>
    <div class="result-box" id="hug_result" style="display:none">
      <div id="hug_detail"></div>
    </div>
    <div style="margin-top:20px">
      <div class="section-label">ì·¨ì•½ê³„ì¸µ ìš°ëŒ€ ì•ˆë‚´</div>
      <div class="note">
        <strong>50% ìš°ëŒ€</strong> (ì¤‘ë³µìš°ëŒ€ ë¶ˆê°€)<br>
        â‘  ë¯¸ì„±ë…„ì ìë…€ 3ì¸ ì´ìƒ (íƒœì•„ í¬í•¨, ì„ì‹ ì§„ë‹¨ì„œ ì²¨ë¶€)<br>
        â‘¡ ë‹¤ë¬¸í™”Â·ì¥ì• ì¸Â·ìœ ê³µì ê°€êµ¬ (í–‰ì •ë³µì§€ì„¼í„° ì¦ëª…ì„œ)<br>
        â‘¢ ê³ ë ¹ì(ë§Œ65ì„¸) ë˜ëŠ” ë…¸ë¶€ëª¨ë´‰ì–‘ (1ë…„ì´ìƒ ì„¸ëŒ€êµ¬ì„±)<br>
        â‘£ í˜¼ì¸ê¸°ê°„ 7ë…„ ì´ë‚´ ì‹ í˜¼ / í•©ì‚°ì†Œë“ 6ì²œë§Œì› ì´í•˜ (ê²°í˜¼ì˜ˆì •ì í¬í•¨)<br><br>
        <strong>60% ìš°ëŒ€</strong> (ì¤‘ë³µìš°ëŒ€ ë¶ˆê°€)<br>
        â‘  í•©ì‚°ì†Œë“ 5ì²œë§Œì› ì´í•˜<br>
        â‘¡ í•œë¶€ëª¨ê°€ì • (í•œë¶€ëª¨ê°€ì¡±ì¦ëª…ì„œ)<br>
        â‘¢ ë§Œ65ì„¸ ë‹¨ë…ì„¸ëŒ€ì£¼
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE 7: ì¥ë˜ì†Œë“ í™˜ì‚° â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="page" id="page7">
  <div class="card">
    <div class="card-header"><span>ğŸ“ˆ</span><h2>ì¥ë˜ì†Œë“ ë°˜ì˜ í™˜ì‚°í‘œ</h2></div>
    <div class="card-tip">ì—°ë ¹ê³¼ ëŒ€ì¶œê¸°ê°„ì— ë”°ë¼ ì¥ë˜ì†Œë“ì„ ë°˜ì˜í•˜ì—¬ ì†Œë“ì„ ìƒí–¥ ì¸ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>
    <div class="field" style="max-width:300px"><label>í˜„ì¬ ì—° ì†Œë“ ì…ë ¥</label><input type="text" id="age_income" placeholder="ì˜ˆ: 80,000,000" oninput="fmtMoney(this); calcAgeTable()"></div>
    <div class="grid-2" style="margin-top:12px">
      <div>
        <div class="section-label">ì¼ë°˜ ëŒ€ì¶œì</div>
        <table class="age-table" id="age_general">
          <thead><tr><th>ì—°ë ¹</th><th>í˜„ì¬ ì†Œë“</th><th>25~29ë…„</th><th>30ë…„ ì´ìƒ</th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
      <div>
        <div class="section-label">ì²­ë…„ Â· ì‹ í˜¼ë¶€ë¶€</div>
        <table class="age-table" id="age_youth">
          <thead><tr><th>ì—°ë ¹</th><th>í˜„ì¬ ì†Œë“</th><th>25~29ë…„</th><th>30ë…„ ì´ìƒ</th></tr></thead>
          <tbody></tbody>
        </table>
        <div class="note" style="margin-top:8px">ì²­ë…„Â·ì‹ í˜¼ë¶€ë¶€ ì—°ì†Œë“ ì…ë ¥ë€ ë³„ë„. ì˜ˆì‹œ ê¸°ì¤€ê°’: 86,000,000ì› ì ìš©.</div>
      </div>
    </div>
  </div>
</div>

</div><!-- /content -->

<script>
/* â”€â”€â”€ Utils â”€â”€â”€ */
function fmtMoney(el){
  let v=el.value.replace(/[^0-9]/g,'');
  if(v) el.value=Number(v).toLocaleString('ko-KR');
  else el.value='';
}
function parseMoney(v){return Number((v||'').toString().replace(/[^0-9]/g,''))||0;}
function pctN(v,d=2){return v.toFixed(d)+'%';}
function won(v){return Math.round(v).toLocaleString('ko-KR')+'ì›';}

function setMeter(id,pct){
  const el=document.getElementById(id);
  if(!el)return;
  const p=Math.min(pct,100);
  el.style.width=p+'%';
  el.style.background= p<40?'var(--safe)':p<60?'var(--warn)':'var(--danger)';
}

/* â”€â”€â”€ Tab â”€â”€â”€ */
function showTab(i){
  document.querySelectorAll('.tab').forEach((t,idx)=>t.classList.toggle('active',idx===i));
  document.querySelectorAll('.page').forEach((p,idx)=>p.classList.toggle('active',idx===i));
}

/* â”€â”€â”€ DSR ëŒ€ì¶œ ìœ í˜• ì •ì˜ â”€â”€â”€ */
const DSR_TYPES_MORTGAGE=[
  {key:'ì£¼ë‹´ëŒ€1',  label:'ì£¼íƒë‹´ë³´ (ì¶”ê°€ì˜ˆì •)',          mode:'annuity'},
  {key:'ì£¼ë‹´ëŒ€2',  label:'ì£¼íƒë‹´ë³´2 (ê¸°ë³´ìœ )',           mode:'annuity'},
  {key:'ì£¼ë‹´ëŒ€3',  label:'ì£¼íƒë‹´ë³´3 (ê¸°ë³´ìœ )',           mode:'annuity'},
  {key:'ì‹ ìš©',     label:'ì‹ ìš©ëŒ€ì¶œ',                    mode:'credit'},   // (ì›ê¸ˆ/5)+ì´ì
  {key:'ì¤‘ë„ê¸ˆ',   label:'ì´ì£¼ë¹„Â·ì¤‘ë„ê¸ˆ',               mode:'interim'},  // (ì›ê¸ˆ/25)+ì´ì
  {key:'ì „ì„¸1',    label:'ì „ì„¸Â·ë³´í—˜Â·ì˜ˆì ê¸ˆë‹´ë³´ 1',      mode:'interest'},
  {key:'ì „ì„¸2',    label:'ì „ì„¸Â·ë³´í—˜Â·ì˜ˆì ê¸ˆë‹´ë³´ 2',      mode:'interest'},
  {key:'ì „ì„¸3',    label:'ì „ì„¸Â·ë³´í—˜Â·ì˜ˆì ê¸ˆë‹´ë³´ 3',      mode:'interest'},
  {key:'ì „ë³´ë‹´',   label:'ì „ì„¸ë³´ì¦ê¸ˆë‹´ë³´',               mode:'jeonse_g'}, // (ì›ê¸ˆ/4)+ì´ì
  {key:'ë¹„ì£¼íƒ',   label:'ë¹„ì£¼íƒë‹´ë³´ (ì§€ê¸‰ë³´ì¦Â·ìƒê°€Â·í† ì§€)',mode:'nonhouse'}, // (ì›ê¸ˆ/8)+ì´ì
  {key:'ê¸°íƒ€',     label:'ê¸°íƒ€ (ì°¨í• ë¶€Â·ë¦¬ìŠ¤Â·í•™ìê¸ˆÂ·ì¹´ë“œë¡ )',mode:'direct'},
];
const DSR_TYPES_JEONSE=[
  {key:'ì „ì„¸ëŒ€ì¶œ', label:'ì „ì„¸ìê¸ˆëŒ€ì¶œ',                 mode:'interest'}, // ì´ìë§Œ
  {key:'ì£¼ë‹´ëŒ€2',  label:'ì£¼íƒë‹´ë³´2 (ê¸°ë³´ìœ )',           mode:'annuity'},
  {key:'ì£¼ë‹´ëŒ€3',  label:'ì£¼íƒë‹´ë³´3 (ê¸°ë³´ìœ )',           mode:'annuity'},
  {key:'ì‹ ìš©',     label:'ì‹ ìš©ëŒ€ì¶œ',                    mode:'credit'},
  {key:'ì¤‘ë„ê¸ˆ',   label:'ì´ì£¼ë¹„Â·ì¤‘ë„ê¸ˆ',               mode:'interim'},
  {key:'ì „ì„¸1',    label:'ì „ì„¸Â·ë³´í—˜Â·ì˜ˆì ê¸ˆë‹´ë³´ 1',      mode:'interest'},
  {key:'ì „ì„¸2',    label:'ì „ì„¸Â·ë³´í—˜Â·ì˜ˆì ê¸ˆë‹´ë³´ 2',      mode:'interest'},
  {key:'ì „ì„¸3',    label:'ì „ì„¸Â·ë³´í—˜Â·ì˜ˆì ê¸ˆë‹´ë³´ 3',      mode:'interest'},
  {key:'ì „ë³´ë‹´',   label:'ì „ì„¸ë³´ì¦ê¸ˆë‹´ë³´',               mode:'jeonse_g'},
  {key:'ë¹„ì£¼íƒ',   label:'ë¹„ì£¼íƒë‹´ë³´',                  mode:'nonhouse'},
  {key:'ê¸°íƒ€',     label:'ê¸°íƒ€ (ì°¨í• ë¶€Â·ë¦¬ìŠ¤Â·í•™ìê¸ˆÂ·ì¹´ë“œë¡ )',mode:'direct'},
];

// ì—°ê°„ ìƒí™˜ì•¡ ê³„ì‚° (ì—‘ì…€ ìˆ˜ì‹ ê·¸ëŒ€ë¡œ: ì—°ë‹¨ìœ„ ì›ë¦¬ê¸ˆê· ë“±)
function annualPayment(P,r,y,mode){
  if(P<=0) return 0;
  switch(mode){
    case 'annuity': // P*r*(1+r)^y / ((1+r)^y - 1)  [ì—‘ì…€ ìˆ˜ì‹]
      if(y<=0||r<=0) return 0;
      const pow=Math.pow(1+r,y);
      return P*r*pow/(pow-1);
    case 'credit':  return (P/5)+(P*r);
    case 'interim': return (P/25)+(P*r);
    case 'interest':return P*r;
    case 'jeonse_g':return (P/4)+(P*r);
    case 'nonhouse':return (P/8)+(P*r);
    case 'direct':  return P; // ì§ì ‘ì…ë ¥ â€” Pê°€ ì—°ê°„ìƒí™˜ì•¡
    default: return 0;
  }
}

function buildDSRRows(tbodyId, types){
  const tb=document.getElementById(tbodyId);
  tb.innerHTML='';
  types.forEach(t=>{
    const tr=document.createElement('tr');
    tr.className='loan-row';
    const needYear= t.mode==='annuity';
    const needRate= t.mode!=='direct';
    const isDirect= t.mode==='direct';
    tr.innerHTML=`
      <td class="type-label">${t.label}</td>
      <td><input type="text" placeholder="${isDirect?'1ë…„ ìƒí™˜ì•¡':'ì›ê¸ˆ'}" id="${tbodyId}_${t.key}_p" oninput="fmtMoney(this)"></td>
      <td><input type="number" placeholder="${needYear?'ë…„':'-'}" id="${tbodyId}_${t.key}_y" ${!needYear?'readonly style="background:var(--bg);color:var(--text3)"':''}></td>
      <td><input type="number" placeholder="${needRate?'%':'-'}" id="${tbodyId}_${t.key}_r" step="0.01" ${!needRate?'readonly style="background:var(--bg);color:var(--text3)"':''}></td>
      <td><input type="text" readonly id="${tbodyId}_${t.key}_amt" placeholder="ìë™ê³„ì‚°"></td>
    `;
    tb.appendChild(tr);
  });
}

function calcDSRRows(tbodyId, types){
  let total=0;
  const rows=[];
  types.forEach(t=>{
    const P=parseMoney(document.getElementById(`${tbodyId}_${t.key}_p`).value);
    const y=Number(document.getElementById(`${tbodyId}_${t.key}_y`)?.value||0);
    const r=Number(document.getElementById(`${tbodyId}_${t.key}_r`)?.value||0)/100;
    const amt=t.mode==='direct'?P:annualPayment(P,r,y,t.mode);
    if(amt>0){
      const amtEl=document.getElementById(`${tbodyId}_${t.key}_amt`);
      if(amtEl) amtEl.value=Math.round(amt).toLocaleString('ko-KR');
      total+=amt;
      rows.push({label:t.label,amt});
    }
  });
  return {total,rows};
}

function resetRows(tbodyId,types){
  types.forEach(t=>{
    ['p','y','r','amt'].forEach(f=>{
      const el=document.getElementById(`${tbodyId}_${t.key}_${f}`);
      if(el&&!el.readOnly) el.value='';
      else if(el&&el.readOnly) el.value='';
    });
  });
}

function showDSRResult(income,total,rows,prefix){
  const dsr=income>0?total/income*100:0;
  const pctEl=document.getElementById(`${prefix}_pct`);
  const badge=document.getElementById(`${prefix}_badge`);
  const meter=`${prefix}_meter`;
  const detail=document.getElementById(`${prefix}_detail`);
  const result=document.getElementById(`${prefix}_result`);

  result.style.display='block';
  pctEl.textContent=pctN(dsr);

  let cls,badgeCls,badgeTxt;
  if(dsr<=40){cls='result-safe';badgeCls='badge-safe';badgeTxt='DSR í†µê³¼ (40% ì´í•˜)';}
  else if(dsr<=60){cls='result-warn';badgeCls='badge-warn';badgeTxt='ì£¼ì˜ (40% ì´ˆê³¼)';}
  else{cls='result-danger';badgeCls='badge-danger';badgeTxt='DSR ì´ˆê³¼ (60%+)';}

  pctEl.className='result-main '+cls;
  badge.className='badge '+badgeCls;
  badge.textContent=badgeTxt;
  setMeter(meter,dsr);

  let html=`<div class="result-row"><span>ì—° ì†Œë“</span><span>${won(income)}</span></div>`;
  rows.forEach(r=>{ html+=`<div class="result-row"><span>${r.label}</span><span>${won(r.amt)}</span></div>`; });
  html+=`<div class="result-row total"><span>ì—°ê°„ ìƒí™˜ì•¡ í•©ê³„</span><span>${won(total)}</span></div>`;
  detail.innerHTML=html;
}

function calcDSR0(){
  const income=parseMoney(document.getElementById('dsr0_income').value);
  if(!income){alert('ì—° ì†Œë“ì„ ì…ë ¥í•˜ì„¸ìš”.');return;}
  const {total,rows}=calcDSRRows('dsr0_rows',DSR_TYPES_MORTGAGE);
  showDSRResult(income,total,rows,'dsr0');
}
function resetDSR0(){
  document.getElementById('dsr0_income').value='';
  resetRows('dsr0_rows',DSR_TYPES_MORTGAGE);
  document.getElementById('dsr0_result').style.display='none';
}

function calcDSR1(){
  const income=parseMoney(document.getElementById('dsr1_income').value);
  if(!income){alert('ì—° ì†Œë“ì„ ì…ë ¥í•˜ì„¸ìš”.');return;}
  const {total,rows}=calcDSRRows('dsr1_rows',DSR_TYPES_JEONSE);
  showDSRResult(income,total,rows,'dsr1');
}
function resetDSR1(){
  document.getElementById('dsr1_income').value='';
  resetRows('dsr1_rows',DSR_TYPES_JEONSE);
  document.getElementById('dsr1_result').style.display='none';
}

/* â”€â”€â”€ ì„œìš¸ë³´ì¦ ê¸ˆìœµë¹„ìœ¨ â”€â”€â”€ */
function calcSGI(){
  const income=parseMoney(document.getElementById('sgi_income').value);
  const p=parseMoney(document.getElementById('sgi_principal').value);
  const r=Number(document.getElementById('sgi_rate').value||0)/100;
  const debt=parseMoney(document.getElementById('sgi_debt').value);
  const dr=Number(document.getElementById('sgi_debt_rate').value||0)/100;
  if(!income){alert('ì—° ì†Œë“ì„ ì…ë ¥í•˜ì„¸ìš”.');return;}
  const sgiAmt=p*r;
  const debtAmt=debt*dr;
  const ratio=(sgiAmt+debtAmt)/income*100;
  const el=document.getElementById('sgi_result');
  el.style.display='block';
  const pctEl=document.getElementById('sgi_pct');
  pctEl.textContent=pctN(ratio);
  pctEl.className='result-main '+(ratio<=40?'result-safe':ratio<=60?'result-warn':'result-danger');
  document.getElementById('sgi_detail').innerHTML=`
    <div class="result-row"><span>ì—° ì†Œë“</span><span>${won(income)}</span></div>
    <div class="result-row"><span>ì„œìš¸ë³´ì¦ ì´ì (${p>0?(r*100).toFixed(2)+'%':''})</span><span>${won(sgiAmt)}</span></div>
    <div class="result-row"><span>ê¸°ì¡´ ë¶€ì±„ ì´ì (${debt>0?(dr*100).toFixed(2)+'%':''})</span><span>${won(debtAmt)}</span></div>
    <div class="result-row total"><span>í•©ì‚° ì´ì</span><span>${won(sgiAmt+debtAmt)}</span></div>
  `;
}

/* â”€â”€â”€ ì„œìš¸ë³´ì¦ DTI â”€â”€â”€ */
function calcDTI(){
  const income=parseMoney(document.getElementById('dti_income').value);
  const p=parseMoney(document.getElementById('dti_p').value);
  const y=Number(document.getElementById('dti_y').value||0);
  const r=Number(document.getElementById('dti_r').value||0)/100;
  const debt=parseMoney(document.getElementById('dti_debt').value);
  const dr=Number(document.getElementById('dti_debt_r').value||0)/100;
  if(!income){alert('ì—° ì†Œë“ì„ ì…ë ¥í•˜ì„¸ìš”.');return;}
  const mortAmt=annualPayment(p,r,y,'annuity');
  const debtInt=debt*dr;
  const dti=(mortAmt+debtInt)/income*100;
  document.getElementById('dti_result').style.display='block';
  const pctEl=document.getElementById('dti_pct');
  pctEl.textContent=pctN(dti);
  const badge=document.getElementById('dti_badge');
  const meter='dti_meter';
  let cls,bc,bt;
  if(dti<=40){cls='result-safe';bc='badge-safe';bt='DTI í†µê³¼ (40%ì´í•˜)';}
  else{cls='result-danger';bc='badge-danger';bt='DTI ì´ˆê³¼';}
  pctEl.className='result-main '+cls;
  badge.className='badge '+bc;badge.textContent=bt;
  setMeter(meter,dti);
  document.getElementById('dti_detail').innerHTML=`
    <div class="result-row"><span>ì‹ ê·œ ì£¼ë‹´ëŒ€ ì›ë¦¬ê¸ˆ</span><span>${won(mortAmt)}</span></div>
    <div class="result-row"><span>ê¸°ì¡´ ë¶€ì±„ ì´ì</span><span>${won(debtInt)}</span></div>
    <div class="result-row total"><span>í•©ì‚°</span><span>${won(mortAmt+debtInt)}</span></div>
    <div class="result-row"><span>ì—° ì†Œë“</span><span>${won(income)}</span></div>
  `;
}

/* â”€â”€â”€ ì‹ DTI â”€â”€â”€ */
function calcNDTI(){
  const income=parseMoney(document.getElementById('ndti_income').value);
  if(!income){alert('ì—° ì†Œë“ì„ ì…ë ¥í•˜ì„¸ìš”.');return;}
  const loans=[
    {label:'ì£¼ë‹´ëŒ€1(ì‹ ê·œ)',p:parseMoney(document.getElementById('ndti_p1').value),y:Number(document.getElementById('ndti_y1').value||0),r:Number(document.getElementById('ndti_r1').value||0)/100},
    {label:'ì£¼ë‹´ëŒ€2(ê¸°ë³´ìœ )',p:parseMoney(document.getElementById('ndti_p2').value),y:Number(document.getElementById('ndti_y2').value||0),r:Number(document.getElementById('ndti_r2').value||0)/100},
    {label:'ì£¼ë‹´ëŒ€3(ê¸°ë³´ìœ )',p:parseMoney(document.getElementById('ndti_p3').value),y:Number(document.getElementById('ndti_y3').value||0),r:Number(document.getElementById('ndti_r3').value||0)/100},
  ];
  let total=0;
  let detail='';
  loans.forEach(l=>{
    const amt=annualPayment(l.p,l.r,l.y,'annuity');
    if(amt>0){total+=amt;detail+=`<div class="result-row"><span>${l.label}</span><span>${won(amt)}</span></div>`;}
  });
  const ndti=total/income*100;
  document.getElementById('ndti_result').style.display='block';
  const pctEl=document.getElementById('ndti_pct');
  pctEl.textContent=pctN(ndti);
  const badge=document.getElementById('ndti_badge');
  let cls,bc,bt;
  if(ndti<=40){cls='result-safe';bc='badge-safe';bt='ì‹ DTI í†µê³¼';}
  else if(ndti<=60){cls='result-warn';bc='badge-warn';bt='ì£¼ì˜';}
  else{cls='result-danger';bc='badge-danger';bt='ì´ˆê³¼';}
  pctEl.className='result-main '+cls;
  badge.className='badge '+bc;badge.textContent=bt;
  setMeter('ndti_meter',ndti);
  document.getElementById('ndti_detail').innerHTML=
    detail+
    `<div class="result-row total"><span>í•©ì‚° ì›ë¦¬ê¸ˆ</span><span>${won(total)}</span></div>
     <div class="result-row"><span>ì—° ì†Œë“</span><span>${won(income)}</span></div>`;
}
function resetNDTI(){
  ['ndti_income','ndti_p1','ndti_y1','ndti_r1','ndti_p2','ndti_y2','ndti_r2','ndti_p3','ndti_y3','ndti_r3'].forEach(id=>{
    const el=document.getElementById(id);if(el)el.value='';
  });
  document.getElementById('ndti_result').style.display='none';
}

/* â”€â”€â”€ ì±„ê¶Œí• ì¸ë¹„ìš© â”€â”€â”€ */
function calcBond(){
  const amt=parseMoney(document.getElementById('bond_amount').value);
  const rate=Number(document.getElementById('bond_rate').value||0)/100;
  if(!amt){alert('ëŒ€ì¶œ ì‹ ì²­ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”.');return;}
  const maxAmt=amt*1.1;
  const cost=maxAmt*0.01*rate;
  document.getElementById('bond_result').style.display='block';
  document.getElementById('bond_detail').innerHTML=`
    <div class="result-row"><span>ëŒ€ì¶œ ì‹ ì²­ê¸ˆì•¡</span><span>${won(amt)}</span></div>
    <div class="result-row"><span>ì±„ê¶Œ ìµœê³ ì•¡ (Ã—110%)</span><span>${won(maxAmt)}</span></div>
    <div class="result-row"><span>ì±„ê¶Œ í• ì¸ìœ¨</span><span>${(rate*100).toFixed(3)}%</span></div>
    <div class="result-row total"><span>ì±„ê¶Œ í• ì¸ë¹„ìš© (ìµœê³ ì•¡Ã—1%Ã—í• ì¸ìœ¨)</span><span style="color:var(--danger)">${won(cost)}</span></div>
  `;
}

/* â”€â”€â”€ ì£¼íƒë³´ì¦ ëŒ€ì¶œí•œë„ â”€â”€â”€ */
function calcHGLimit(){
  const income=parseMoney(document.getElementById('hg_income').value);
  const debt=parseMoney(document.getElementById('hg_debt').value);
  if(!income){alert('ì—° ì†Œë“ì„ ì…ë ¥í•˜ì„¸ìš”.');return;}
  const configs=[
    {label:'ì¼ë°˜', mult:3.5},
    {label:'ì‹ í˜¼ë¶€ë¶€', mult:4.0},
    {label:'ì±„ê¶Œë³´ì¡´', mult:4.0},
    {label:'ì‹ í˜¼ë¶€ë¶€+ì±„ê¶Œë³´ì¡´', mult:4.5},
  ];
  document.getElementById('hg_limit_result').style.display='block';
  const tbody=document.getElementById('hg_limit_rows');
  tbody.innerHTML=configs.map(c=>{
    const limit=income*c.mult - debt/4;
    return `<tr ${limit<0?'class="highlight"':''}><td>${c.label} (ì†Œë“Ã—${c.mult} - ë¶€ì±„/4)</td><td style="font-family:'JetBrains Mono',monospace;color:${limit>0?'var(--gold2)':'var(--danger)'}">${won(Math.max(0,limit))}</td></tr>`;
  }).join('');
}

/* â”€â”€â”€ ì£¼íƒë³´ì¦ ë³´ì¦ë£Œ â”€â”€â”€ */
function calcHGFee(){
  const loan=parseMoney(document.getElementById('hg_loan').value);
  const type=document.getElementById('hg_fee_type').value;
  if(!loan){document.getElementById('hg_fee_result').style.display='none';return;}
  const guar=loan*0.9;
  document.getElementById('hg_fee_result').style.display='block';

  // êµ¬ê°„ ë¶„í• 
  const brackets=[
    {max:100000000,  rate:0.0006,  label:'1ì–µ ì´í•˜'},
    {max:200000000,  rate:0.0008,  label:'1ì–µì´ˆê³¼~2ì–µ'},
    {max:300000000,  rate:0.001,   label:'2ì–µì´ˆê³¼~3ì–µ'},
    {max:400000000,  rate:0.0012,  label:'3ì–µì´ˆê³¼~4ì–µ'},
  ];
  const specialRate=0.0002;

  function calcByBrackets(g, addRate){
    let remain=g, fee=0, detail='';
    let prev=0;
    for(const b of brackets){
      if(remain<=0) break;
      const chunk=Math.min(remain, b.max-prev);
      const r=b.rate+(addRate||0);
      const f=chunk*r;
      fee+=f;
      detail+=`<div class="result-row"><span>${b.label} (${(r*100).toFixed(2)}%)</span><span>${won(f)}</span></div>`;
      remain-=chunk;prev=b.max;
    }
    if(remain>0){detail+=`<div class="result-row" style="color:var(--warn)"><span>4ì–µ ì´ˆê³¼ë¶„ â€” ìˆ˜ê¸° ê³„ì‚° í•„ìš”</span><span>${won(remain)}</span></div>`;}
    return {fee, detail};
  }

  let html=`<div class="result-row"><span>ëŒ€ì¶œ ì‹ ì²­ê¸ˆì•¡</span><span>${won(loan)}</span></div>
            <div class="result-row"><span>ë³´ì¦ê¸ˆì•¡ (Ã—90%)</span><span>${won(guar)}</span></div>
            <hr class="divider">`;
  if(type==='normal'){
    const {fee,detail}=calcByBrackets(guar,0);
    html+=detail+`<div class="result-row total"><span>ì¼ë°˜ ë³´ì¦ë£Œ</span><span>${won(fee)}</span></div>`;
  }else if(type==='surcharge'){
    const {fee,detail}=calcByBrackets(guar,0.002);
    html+=detail+`<div class="result-row total"><span>í• ì¦ ë³´ì¦ë£Œ</span><span>${won(fee)}</span></div>`;
  }else{
    const fee=guar*specialRate;
    html+=`<div class="result-row"><span>ì ìš© ìš”ìœ¨ (0.02%)</span><span>-</span></div>
           <div class="result-row total"><span>ìš°ëŒ€ ë³´ì¦ë£Œ</span><span>${won(fee)}</span></div>`;
  }
  document.getElementById('hg_fee_detail').innerHTML=html;
}

/* â”€â”€â”€ ë„ì‹œë³´ì¦ ë³´ì¦ë£Œ â”€â”€â”€ */
function calcHUG(){
  const insure=parseMoney(document.getElementById('hug_insure').value);
  const loan=parseMoney(document.getElementById('hug_loan').value);
  if(!insure||!loan){alert('ë°˜í™˜ë³´ì¦ ê°€ì…ê¸ˆì•¡ê³¼ ëŒ€ì¶œ ì‹ ì²­ê¸ˆì•¡ì„ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');return;}
  const normal=(loan*0.00031*2)+(insure*0.00128*2);
  const d50=normal*0.5;
  const d60=normal*0.4;
  document.getElementById('hug_result').style.display='block';
  document.getElementById('hug_detail').innerHTML=`
    <div class="result-row"><span>ë°˜í™˜ë³´ì¦ ê°€ì…ê¸ˆì•¡</span><span>${won(insure)}</span></div>
    <div class="result-row"><span>ëŒ€ì¶œ ì‹ ì²­ê¸ˆì•¡</span><span>${won(loan)}</span></div>
    <hr class="divider">
    <div class="result-row"><span>ì‚°ì¶œì‹</span><span style="font-size:11px;color:var(--text2)">(ëŒ€ì¶œÃ—0.031%Ã—2)+(ê°€ì…ê¸ˆì•¡Ã—0.128%Ã—2)</span></div>
    <div class="result-row total"><span>ì¼ë°˜ ë³´ì¦ë£Œ (2ë…„ì¹˜)</span><span>${won(normal)}</span></div>
    <div class="result-row"><span>ì·¨ì•½ê³„ì¸µ 50% ìš°ëŒ€</span><span style="color:var(--safe)">${won(d50)}</span></div>
    <div class="result-row"><span>ì·¨ì•½ê³„ì¸µ 60% ìš°ëŒ€</span><span style="color:var(--safe)">${won(d60)}</span></div>
  `;
}

/* â”€â”€â”€ ì¥ë˜ì†Œë“ í™˜ì‚°í‘œ â”€â”€â”€ */
function calcAgeTable(){
  const income=parseMoney(document.getElementById('age_income').value)||0;
  const yIncome=86000000; // ì²­ë…„ ê¸°ì¤€ (ì—‘ì…€ E6ê°’)

  const ages=[
    {label:'20~24ì„¸', gMult110:true, gMult110_30:true, yMult120:true, yMult120_30:true},
    {label:'25~29ì„¸', gMult110:true, gMult110_30:true, yMult120:true, yMult120_30:true},
    {label:'30~34ì„¸', gMult110:true, gMult110_30:true, yMult120:true, yMult120_30:true},
    {label:'35~39ì„¸', gMult110:true, gMult110_30:'X',  yMult120:true, yMult120_30:'X'},
  ];

  function cell(v){
    if(v==='X') return `<td style="color:var(--danger)">X</td>`;
    if(v===0)   return `<td style="color:var(--text3)">-</td>`;
    return `<td style="font-family:'JetBrains Mono',monospace">${Math.round(v).toLocaleString('ko-KR')}</td>`;
  }

  let gHtml='', yHtml='';
  ages.forEach(a=>{
    const g25 = income>0 && a.gMult110!==false ? income*1.1 : 0;
    const g30 = income>0 && a.gMult110_30!=='X' ? income*1.1 : 'X';
    const y25 = yIncome*1.2;
    const y30 = a.yMult120_30!=='X' ? yIncome*1.2 : 'X';
    gHtml+=`<tr><td>${a.label}</td><td style="font-family:'JetBrains Mono',monospace">${income?income.toLocaleString('ko-KR'):'-'}</td>${cell(g25)}${cell(g30)}</tr>`;
    yHtml+=`<tr><td>${a.label}</td><td style="font-family:'JetBrains Mono',monospace">${yIncome.toLocaleString('ko-KR')}</td>${cell(y25)}${cell(y30)}</tr>`;
  });
  document.querySelector('#age_general tbody').innerHTML=gHtml;
  document.querySelector('#age_youth tbody').innerHTML=yHtml;
}

/* â”€â”€â”€ Init â”€â”€â”€ */
buildDSRRows('dsr0_rows', DSR_TYPES_MORTGAGE);
buildDSRRows('dsr1_rows', DSR_TYPES_JEONSE);
calcAgeTable();
</script>
</body>
</html>
